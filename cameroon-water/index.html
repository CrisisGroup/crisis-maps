<html>

<head>
	<meta charset="utf-8">
	<title>Cameroon's Water Crisis</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
	<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"
		integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://use.typekit.net/nqh8ygh.css">
	<link href='style.css' rel='stylesheet' />
</head>

<body>

	<div class="box">

		<button id="originalPosition">Navigate the Timeline →</button>

		<h1>Timeline of Cameroon’s Water Crisis</h1>

	</div>

	<div id="map"></div>

	<div id="mapInset"></div>

	<div id="locationInfo" style="display: none;">
		<h2 id="locationTitle"></h2>
		<p id="locationDescription"></p>
	</div>

	<div id="navigationControls">
		<button class="locationButton" data-location="0">10 August 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center;">&#x7c;</span>
		<button class="locationButton" data-location="1">14 August 2021</button>
		<span style="color: fff; font-weight: bold; align-self: center;">|</span>
		<button class="locationButton" data-location="2">23 September 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center;">|</span>
		<button class="locationButton" data-location="3">2 October 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center;">|</span>
		<button class="locationButton" data-location="4">5 December 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center;">|</span>
		<button class="locationButton" data-location="5">8 December 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center;">|</span>
		<button class="locationButton" data-location="6">15 December 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center;">|</span>
		<button class="locationButton" data-location="7">11 January 2022</button>
		<span style="color: #fff; font-weight: bold; align-self: center;">|</span>
		<button class="locationButton" data-location="8">Looking Ahead</button>
	</div>

	<script>

		// Show the map container
		document.getElementById('map').style.display = 'block';

		mapboxgl.accessToken = 'pk.eyJ1IjoiZGFsdG9ud2IiLCJhIjoiOWdSSXFQSSJ9.HZyjh4g3TAAOAncwelv9Vw';
		const map = new mapboxgl.Map({
			container: 'map',
			style: 'mapbox://styles/daltonwb/cluskejgz001a01qj6wnpgo81',
			zoom: 8.5,
			bearing: -20,
			center: [14.863725, 11.592343],
			projection: 'globe',
			pitch: 45,
			maxZoom: 14,
			minZoom: 8,
			maxBounds: [[12.803782352780502, 10.268535070350396], [17.043613795438773, 13.055481325837178]],
			dragPan: false,
			scrollZoom: false,
			doubleClickZoom: false,
			interactive: false,
			attributionControl: false
		});

		map.on('load', function () {
			document.getElementById('originalPosition').onclick = function () {
				map.flyTo({
					center: [14.863725, 11.592343],  // Longitude, Latitude
					zoom: 8.5,
					bearing: -20,
					pitch: 45
				});

				// Hide the locationInfo element
				document.getElementById('locationInfo').style.display = 'none';
			};
		});

		var locations = [
			{ lat: 11.79426383, lon: 15.14228381, pitch: 35, bearing: -57.5, zoom: 14, title: '10 August 2021 | CHAD', description: 'FIRST WAVE OF VIOLENCE - The violent clash began on 10 August in Missiska, in the Logone Birni district of Cameroon’s Far North region, when cattle belonging to Choa Arab herders got trapped into a fishing canal dug by Musgum fisherfolk, triggering a cycle of violent retaliation. The Musgum community evacuated women and children to their Chadian Musgum sister community living on the otherside of the border, across the Logone River. The conflict killed at least 45 people and injured 74 others. At least 19 villages were burnt and 40 others abandoned by their inhabitants.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '14 August 2021 | CAMEROON', description: 'Far North Governor Midjiyawa Bakari visit in Kousseri to ease tensions. Authorities ordered the deployment of security forces in more than one hundred affected villages in the area. Meanwhile, community leaders read a joint statement where they commit “to spare no effort for a definitive return of peace between the two communities that coexist”.' },
			{ lat: 11.39823307, lon: 14.56872937, pitch: 0, bearing: 0, zoom: 14.5, title: '23 September 2021 | CAMEROON', description: 'Choa people from Malia and Toukoumaya villages clashed in a land dispute around Waza town (Logone-et-Chari, Far North). Five people were injured' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '2 October 2021 | CAMEROON', description: 'Members of the Arab and Musgum ethnic groups clashed in Gueli neighborhood of Kousseri (Logone-et-Chari, Far North) after a private dispute between two members of both groups. One person was injured, and a vehicle burnt down.' },
			{ lat: 11.39823307, lon: 14.56872937, pitch: 0, bearing: 0, zoom: 14.5, title: '5 December 2021 | CAMEROON', description: 'SECOND WAVE OF VIOLENCE - Clashes between communities of herders, farmers and fisherfolk broke out on 5 December in the village of Ouloumsa, Logone-Birni town, Far North.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '8 December 2021 | CAMEROON', description: 'Clashes between communities of herders, farmers and fishermen which broke out in the village of Ouloumsa, Far North Cameroon spread across villages quickly, reaching Kousseri, the capital of Logone-et-Chari on 8 December 2021.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '15 December 2021 | CAMEROON', description: 'Governmental delegation including the minister of territorial administration, politicians and military officials consulted  Choa Arabs and Musgum traditional authorities in a peacebuilding outreach.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '11 January 2022 | CAMEROON', description: 'Choa Arab young men demonstrated in Kousseri town (Logone-et-Chari, Far North) against the arrest of two members of their community the previous day. Gendarmes fired shots in the air to disperse them.' },
			{ lat: 11.592343, lon: 14.863725, pitch: 15, bearing: 0, zoom: 8, title: 'What\'s Next?', description: 'To start the timeline over, tap the button on the left.' },
		];

		var currentLocation = 0;

		function navigateLocations() {
			if (currentLocation >= locations.length) {
				currentLocation = 0; // Loop back to the first location
			}
			updateMapAndView(locations[currentLocation]);
			currentLocation++;
		}

		function updateMapAndView(location) {
			map.flyTo({
				center: [location.lon, location.lat],
				pitch: location.pitch,
				bearing: location.bearing,
				zoom: location.zoom,
				speed: .8,
				essential: true // this animation is considered essential with respect to prefers-reduced-motion
			});

			// Update HTML content
			document.getElementById('locationTitle').innerText = location.title || 'Location Title';
			document.getElementById('locationDescription').innerText = location.description || 'Location description here.';
			document.getElementById('locationInfo').style.display = 'block'; // Make the container visible
		}

		function jumpToLocation(index) {
			// Since this is called by direct jump buttons, stop the sequential navigation
			currentLocation = index; // Set current location to index for potential future navigation control
			updateMapAndView(locations[index]);
		}

		// document.getElementById('startAnimationButton').addEventListener('click', navigateLocations);

		// Attach event listeners to the navigation buttons
		var navButtons = document.querySelectorAll('.locationButton');
		navButtons.forEach(button => {
			button.addEventListener('click', function () {
				var index = this.getAttribute('data-location');
				jumpToLocation(parseInt(index, 10));
			});
		});

		const insetMap = new mapboxgl.Map({
			container: 'mapInset',
			style: 'mapbox://styles/daltonwb/clujzh5s103nd01nw7lco2zk3',
			center: [14.863725, 11.592343],
			zoom: 2,
			hash: false,
			interactive: false,
			projection: 'mercator',
			attributionControl: false
		});

		insetMap.on('load', () => {

			insetMap.addSource('boundsSource', {
				'type': 'geojson',
				'data': {
					"type": "FeatureCollection",
					"features": [
						{
							"type": "Feature",
							"properties": {},
							"geometry": {
								"coordinates": [
									[
										[
											12.803783031458977,
											13.05263832236892
										],
										[
											12.803783031458977,
											10.268532663973957
										],
										[
											17.043614474117277,
											10.268532663973957
										],
										[
											17.043614474117277,
											13.05263832236892
										],
										[
											12.803783031458977,
											13.05263832236892
										]
									]
								],
								"type": "Polygon"
							}
						}
					]
				}
			});

			insetMap.addLayer({
				'id': 'boundsLayer',
				'type': 'fill',
				'source': 'boundsSource', // reference the data source
				'layout': {},
				'paint': {
					'fill-color': '#ccc', // blue color fill
					'fill-opacity': 0.4
				}
			});
			// // Add a black outline around the polygon.
			insetMap.addLayer({
				'id': 'outlineLayer',
				'type': 'line',
				'source': 'boundsSource',
				'layout': {},
				'paint': {
					'line-color': '#fff',
					'line-width': 1
				}
			});
		});

		map.scrollZoom.disable();
		map.addControl(new mapboxgl.AttributionControl({
			customAttribution: 'International Crisis Group | Map: Paul Franz and Claire Boccon-Gibod'
		}));

	</script>

</body>

</html>