<!DOCTYPE html>
<html>

<head>
	<!DOCTYPE html>
	<html>

	<head>
		<meta charset="utf-8">
		<title>Cameroon's Water Crisis</title>
		<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
		<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
		<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
		<script src="https://code.jquery.com/jquery-3.5.1.min.js"
			integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://use.typekit.net/kjv8sgv.css">
		<link href='style.css' rel='stylesheet' />

	</head>

<body>

	<div class="box">

		<h1>TIMELINE OF CAMEROON'S WATER <span style="color:#e87722;">CRISIS</span></h1>

		<nav id="menu"></nav>
	</div>

	<div id="map"></div>
	<div id="loading">
		<div id="ukraine" class="custom-marker">
			<h2>Boat trip across the sea | Necoclí <span style="color: #e87722;">~$40 USD</span></h2>
		</div>
		<div id="afghan" class="custom-marker">
			<h2>Trip through the jungle to Panamá's border | Acandí <span style="color: #e87722;">~$160 USD</span> </h2>
		</div>
		<div id="sudan" class="custom-marker">
			<h2>Canoe trip along the river | Bajo Chiquito <span style="color: #e87722;">~$25 USD</span></h2>
		</div>
		<div id="southSudan" class="custom-marker">
			<h2>Bus trip to Costa Rica's border | Lajas Blancas <span style="color: #e87722;">~$60 USD</span></h2>
		</div>
	</div>

	<div id="mobilemenu"></div>
	<div id="mapInset"></div>
	<button id="startAnimationButton">Navigate the Timeline</button>

	<script>
		document.getElementById('loading').style.display = 'none';

		// Show the map container
		document.getElementById('map').style.display = 'block';

		mapboxgl.accessToken = 'pk.eyJ1IjoiZGFsdG9ud2IiLCJhIjoiOWdSSXFQSSJ9.HZyjh4g3TAAOAncwelv9Vw';
		const map = new mapboxgl.Map({
			container: 'map',
			style: 'mapbox://styles/daltonwb/clu9th7bp01es01nwh2sv5g7z',
			zoom: 9,
			bearing: -20,
			center: [14.863725, 11.592343],
			projection: 'globe',
			pitch: 45,
			maxZoom: 14,
			minZoom: 8,
			maxBounds: [[12.803782352780502, 10.268535070350396], [17.043613795438773, 13.055481325837178]],
			showZoom: true,
			attributionControl: false
		});

		var locations = [
			{ lat: 11.79426383, lon: 15.14228381, pitch: 0, bearing: 0, zoom: 10 },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 0, bearing: 0, zoom: 11 },
			{ lat: 11.39823307, lon: 14.56872937, pitch: 0, bearing: 0, zoom: 10 },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 0, bearing: 0, zoom: 11 },
			{ lat: 11.8250052, lon: 15.091314, pitch: 0, bearing: 0, zoom: 10 },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 0, bearing: 0, zoom: 11 },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 0, bearing: 0, zoom: 10 },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 0, bearing: 0, zoom: 11 },
			{ lat: 11.592343, lon: 14.863725, pitch: 45, bearing: -20, zoom: 9 },
		];

		var currentLocation = 0;

		function navigateLocations() {
			if (currentLocation >= locations.length) {
				currentLocation = 0; // Loop back to the first location
			}
			var loc = locations[currentLocation];
			map.flyTo({
				center: [loc.lon, loc.lat],
				pitch: loc.pitch,
				bearing: loc.bearing,
				zoom: loc.zoom,
				essential: true // this animation is considered essential with respect to prefers-reduced-motion
			});
			currentLocation++;
		}

		document.getElementById('startAnimationButton').addEventListener('click', navigateLocations);

		const insetMap = new mapboxgl.Map({
			container: 'mapInset', // container id
			style: 'mapbox://styles/daltonwb/cloimyix8003101qsgjpifqkf', //hosted style id
			center: [14.863725, 11.592343],
			zoom: 3,
			hash: false,
			interactive: false,
			projection: 'mercator',
			attributionControl: false
		});

		insetMap.on('load', () => {

			insetMap.addSource('boundsSource', {
				'type': 'geojson',
				'data': {
					"type": "FeatureCollection",
					"features": [
						{
							"type": "Feature",
							"properties": {},
							"geometry": {
								"coordinates": [
									[
										[
											12.803783031458977,
											13.05263832236892
										],
										[
											12.803783031458977,
											10.268532663973957
										],
										[
											17.043614474117277,
											10.268532663973957
										],
										[
											17.043614474117277,
											13.05263832236892
										],
										[
											12.803783031458977,
											13.05263832236892
										]
									]
								],
								"type": "Polygon"
							}
						}
					]
				}
			});

			insetMap.addLayer({
				'id': 'boundsLayer',
				'type': 'fill',
				'source': 'boundsSource', // reference the data source
				'layout': {},
				'paint': {
					'fill-color': '#ccc', // blue color fill
					'fill-opacity': 0.4
				}
			});
			// // Add a black outline around the polygon.
			insetMap.addLayer({
				'id': 'outlineLayer',
				'type': 'line',
				'source': 'boundsSource',
				'layout': {},
				'paint': {
					'line-color': '#fff',
					'line-width': 1
				}
			});
		});

		map.addControl(new mapboxgl.NavigationControl());
		map.scrollZoom.disable();
		map.addControl(new mapboxgl.FullscreenControl());
		map.addControl(new mapboxgl.AttributionControl({
			customAttribution: 'International Crisis Group | Map: Paul Franz and Claire Boccon-Gibod'
		}));

	</script>

</body>

</html>