<html>

<head>
	<meta charset="utf-8">
	<title>Cameroon's Water Crisis</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
	<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"
		integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://use.typekit.net/nqh8ygh.css">
	<link href='style.css' rel='stylesheet' />
</head>

<body>

	<div class="box">

		<button id="originalPosition">Navigate the Timeline →</button>
		<button id="mobileButton">Next →</button>

		<h1>Timeline of Cameroon’s Water Crisis</h1>

	</div>

	<div id="map"></div>

	<div id="mapInset"></div>

	<div id="locationInfo" style="display: none;">
		<h2 id="locationTitle"></h2>
		<p id="locationDescription"></p>
	</div>

	<div id="navigationControls">
		<button class="locationButton" data-location="0">10 August 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">&#x7c;</span>
		<button class="locationButton" data-location="1">14 August 2021</button>
		<span style="color: fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="2">23 September 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="3">2 October 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="4">5 December 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="5">8 December 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="6">15 December 2021</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="7">11 January 2022</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="8">6-7 October 2023</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="9">Dec 2023 - Feb 2024</button>
		<span style="color: #fff; font-weight: bold; align-self: center; font-size: 10px;">|</span>
		<button class="locationButton" data-location="10">Looking Ahead</button>
	</div>

	<script>

		// Show the map container
		document.getElementById('map').style.display = 'block';

		function getZoomLevel() {
			const width = window.innerWidth;
			if (width < 600) {
				return 6.5; // More zoomed out for smaller devices
			} else if (width >= 600 && width < 1000) {
				return 7;
			} else {
				return 8; // More zoomed in for larger devices
			}
		}

		mapboxgl.accessToken = 'pk.eyJ1IjoiZGFsdG9ud2IiLCJhIjoiOWdSSXFQSSJ9.HZyjh4g3TAAOAncwelv9Vw';
		const map = new mapboxgl.Map({
			container: 'map',
			style: 'mapbox://styles/daltonwb/clvcnz2i401du01pe0euf1pw7',
			zoom: getZoomLevel(),
			bearing: -20,
			center: [14.863725, 11.592343],
			projection: 'globe',
			pitch: 45,
			maxZoom: 14,
			minZoom: 6.5,
			maxBounds: [[12.803782352780502, 10.268535070350396], [17.043613795438773, 13.055481325837178]],
			dragPan: false,
			scrollZoom: false,
			doubleClickZoom: false,
			interactive: false,
			attributionControl: false
		});

		window.addEventListener('resize', function () {
			map.setZoom(getZoomLevel());
		});

		map.on('load', function () {
			document.getElementById('originalPosition').onclick = function () {
				map.flyTo({
					center: [14.863725, 11.592343],  // Longitude, Latitude
					zoom: 8.5,
					bearing: -20,
					pitch: 45
				});

				// Hide the locationInfo element
				document.getElementById('locationInfo').style.display = 'none';
			};
		});

		var locations = [
			{ lat: 11.79426383, lon: 15.14228381, pitch: 35, bearing: -57.5, zoom: 14, title: '10 August 2021 | CHAD', description: 'FIRST WAVE OF VIOLENCE – In the village of Missiska in the Logone Birni division (Logone-et-Chari, Far North), violent clashes erupted when a basin dug by Musgum fisherfolk trapped and killed cattle belonging to Arab Choa herders. The Musgum evacuated women and children to their Musgum sister community living on the other side of the Logone River in Chad. The conflict killed at least 45 people and injured 74 others. At least nineteen villages burned down and 40 others were abandoned by the inhabitants.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '14 August 2021 | CAMEROON', description: 'Far North Governor Midjiyawa Bakari visited Kousseri, the capital of Logone-et-Chari, to ease tensions. Authorities ordered the deployment of security forces in more than one hundred affected villages in the area. Meanwhile, community leaders read a joint statement in which they committed “to spare no effort for a definitive return of peace between the two communities that coexist”.' },
			{ lat: 11.39823307, lon: 14.56872937, pitch: 0, bearing: 0, zoom: 14.5, title: '23 September 2021 | CAMEROON', description: 'Arab Choa people from Malia and Toukoumaya villages clashed in a land dispute around Waza, a town in Logone-et-Chari. Five people were injured.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '2 October 2021 | CAMEROON', description: 'Choa Arabs and Musgum clashed in Kousseri’s Gueli neighborhood after a dispute between members of the groups. One person was injured, and a vehicle was torched.' },
			{ lat: 11.39823307, lon: 14.56872937, pitch: 0, bearing: 0, zoom: 14.5, title: '5 December 2021 | CAMEROON', description: 'SECOND WAVE OF VIOLENCE – Clashes among herders, farmers and fisherfolk broke out in the village of Ouloumsa, Logone-Birni town, Far North.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '8 December 2021 | CAMEROON', description: 'The clashes that broke out in Ouloumsa spread through villages quickly, reaching Kousseri on 8 December 2021. At least 44 were killed and more than 100 injured.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '15 December 2021 | CAMEROON', description: 'Governmental delegation including the minister of territorial administration, politicians and military officials consulted Arab Choas and Musgum traditional authorities in a peacebuilding outreach. About 100,000 people had been displaced.' },
			{ lat: 12.08725499, lon: 15.01527438, pitch: 35, bearing: -40, zoom: 14, title: '11 January 2022 | CAMEROON', description: 'In Kousseri, security forces clamp down on Arab Choa crowds protesting the arrest of the former mayor accused of involvement in the December 2021 killings, leading to four casualties and arrests. The next day, Musgums and Arab Choas clashed with live ammunition after accusing them of killing two members of the Musgum community.' },
			{ lat: 12.56270807, lon: 14.44745073, pitch: 35, bearing: -40, zoom: 14, title: '6-7 October 2023 | CAMEROON', description: 'Between 6 and 7 October 2023, Kotoko farmers clashed with Arab Choa herders in Makary, Goulfey, Amdagalgui and Ngouma (Logone-et-Chari, Far North) leading to at least two casualties and 20 persons injured.' },
			{ lat: 12.87759002, lon: 14.29758313, pitch: 35, bearing: -40, zoom: 14, title: 'December 2023 - February 2024 | CAMEROON', description: 'Boko Haram and Islamic State West Africa Province militants launched over a dozen attacks on fishing communities in the northern part of Logone-et-Chari division, abducting around 25 people and killing at least seven. Thousands fled to the southern parts of the division, increasing the pressure on available resources in that area.' },
			{ lat: 11.592343, lon: 14.863725, pitch: 15, bearing: 0, zoom: 8, title: 'Looking Ahead', description: 'In February 2024, stakeholders met in Yaounde to harmonise plans for the development of the Far North as a presidential reconstruction programme announced in May 2022 and estimated at $3 billion is set for implementation later in the year.' },
		];

		var currentLocation = 0;

		function navigateLocations() {
			if (currentLocation >= locations.length) {
				currentLocation = 0; // Loop back to the first location
			}
			updateMapAndView(locations[currentLocation]);
			currentLocation++;
		}

		function updateMapAndView(location) {
			map.flyTo({
				center: [location.lon, location.lat],
				pitch: location.pitch,
				bearing: location.bearing,
				zoom: location.zoom,
				speed: .4,
				curve: 1.5,
				essential: true // this animation is considered essential with respect to prefers-reduced-motion
			});

			// Update HTML content
			document.getElementById('locationTitle').innerText = location.title || 'Location Title';
			document.getElementById('locationDescription').innerText = location.description || 'Location description here.';
			document.getElementById('locationInfo').style.display = 'block'; // Make the container visible
		}

		function jumpToLocation(index) {
			// Since this is called by direct jump buttons, stop the sequential navigation
			currentLocation = index; // Set current location to index for potential future navigation control
			updateMapAndView(locations[index]);
		}

		document.getElementById('mobileButton').addEventListener('click', navigateLocations);

		// Attach event listeners to the navigation buttons
		var navButtons = document.querySelectorAll('.locationButton');
		navButtons.forEach(button => {
			button.addEventListener('click', function () {
				var index = this.getAttribute('data-location');
				jumpToLocation(parseInt(index, 10));
			});
		});

		const insetMap = new mapboxgl.Map({
			container: 'mapInset',
			style: 'mapbox://styles/daltonwb/clv41w08a00gt01qv2ylb2pfc',
			center: [14.863725, 11.592343],
			zoom: 2,
			hash: false,
			interactive: false,
			projection: 'globe',
			attributionControl: false
		});

		insetMap.on('load', () => {

			insetMap.addSource('boundsSource', {
				'type': 'geojson',
				'data': {
					"type": "FeatureCollection",
					"features": [
						{
							"type": "Feature",
							"properties": {},
							"geometry": {
								"coordinates": [
									[
										[
											12.803783031458977,
											13.05263832236892
										],
										[
											12.803783031458977,
											10.268532663973957
										],
										[
											17.043614474117277,
											10.268532663973957
										],
										[
											17.043614474117277,
											13.05263832236892
										],
										[
											12.803783031458977,
											13.05263832236892
										]
									]
								],
								"type": "Polygon"
							}
						}
					]
				}
			});

			insetMap.addLayer({
				'id': 'boundsLayer',
				'type': 'fill',
				'source': 'boundsSource', // reference the data source
				'layout': {},
				'paint': {
					'fill-color': '#ccc', // blue color fill
					'fill-opacity': 0.4
				}
			});
			// // Add a black outline around the polygon.
			insetMap.addLayer({
				'id': 'outlineLayer',
				'type': 'line',
				'source': 'boundsSource',
				'layout': {},
				'paint': {
					'line-color': '#798271',
					'line-width': 1
				}
			});
		});

		map.scrollZoom.disable();
		map.addControl(new mapboxgl.AttributionControl({
			customAttribution: 'International Crisis Group | Map: Paul Franz and Claire Boccon-Gibod'
		}));

	</script>

</body>

</html>